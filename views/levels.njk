{% from "govuk/components/tabs/macro.njk" import govukTabs %}
{% from "govuk/components/table/macro.njk" import govukTable %}

{% macro _row( r) %}
    [
        {
        text: r.station
        },
        {
        text: r.height
        },
        {
        text: r.trend
        },
        {
        text: r.state
        }
    ]
{% endmacro %}

{% macro _rows( data) %}
    {% for r in data %}
        {{ _row( r) }}
        {% if not loop.last %},{% endif %}
    {% endfor %}
{% endmacro %}

{% macro _floodTable(data) %}

    {{ govukTable({
        head: [
            {
                text: "Measuring Station"
            },
            {
                text: "Height"
            },
            {
                text: "Trend"
            },
            {
                text: "State"
            }
        ],
        rows: [ _rows(data)  ]
    }) }}
{% endmacro %}

{% macro levels( river, sea, rainfall, groundwater ) %}

    {% set riverHtml %}
        <h2 class="govuk-heading-m">River</h2>
        {{ _floodTable(river) }}
    {% endset %}

    {% set seaHtml %}
        <h2 class="govuk-heading-m">Sea</h2>
        {{ _floodTable(sea) }}
    {% endset %}

    {% set rainfallHtml %}
        <h2 class="govuk-heading-m">Rainfall</h2>
        {{ _floodTable(rainfall) }}
    {% endset %}

    {% set groundwaterHtml %}
        <h2 class="govuk-heading-m">Groundwater</h2>
        {{ _floodTable(groundwater) }}
    {% endset %}

    <h1 class="govuk-heading-m">Water levels</h1>

    {{ govukTabs({
        items: [
            {
                label: "River",
                id: "river",
                panel: {
                html: riverHtml
            }
            },
            {
                label: "Sea",
                id: "sea",
                panel: {
                html: ""
            }
            },
            {
                label: "Rainfall",
                id: "rainfall",
                panel: {
                html: ""
            }
            },
            {
                label: "Groundwater",
                id: "groundwater",
                panel: {
                html: ""
            }
            }
        ]
    }) }}
{% endmacro %}
